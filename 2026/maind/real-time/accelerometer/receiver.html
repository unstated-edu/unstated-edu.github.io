<!doctype html>
<html>
  <head>
    <title>Receiver</title>
    <style>
      body {
        margin: 0;
        background: #111;
        overflow: hidden;
      }
      #ball {
        width: 80px;
        height: 80px;
        background: #00ff88;
        border-radius: 50%;
        position: absolute;
        transform: translate(-50%, -50%);
        transition:
          left 0.1s,
          top 0.1s;
      }
      #info {
        position: fixed;
        top: 20px;
        left: 20px;
        color: white;
        font-family: Arial;
        font-size: 18px;
        line-height: 2;
      }
    </style>
  </head>
  <body>
    <div id="info">Waiting for phone... ðŸ“±</div>
    <div id="ball"></div>

    <!-- Ably library -->
    <script src="https://cdn.ably.com/lib/ably.min-2.js"></script>
    <script>
      // same API key
      const API_KEY = "biplaQ.iovzWA:ffx3oR9mKYBjDAfLiHlVJ4KWacO_9mEU6KOocxicrKY;

      const client = new Ably.Realtime(API_KEY);
      const channel = client.channels.get("motion");

      const ball = document.getElementById("ball");
      const info = document.getElementById("info");

      // listen for incoming motion data
      channel.subscribe("update", (msg) => {
        const data = msg.data;

        info.innerHTML = `alpha: ${data.alpha}<br>beta: ${data.beta}<br>gamma: ${data.gamma}`;

        // map gamma (-90 to 90) â†’ horizontal
        const x = map(data.gamma, -90, 90, 0, window.innerWidth);

        // map beta (-90 to 90) â†’ vertical
        const y = map(data.beta, -90, 90, 0, window.innerHeight);

        ball.style.left = x + "px";
        ball.style.top = y + "px";
      });

      function map(value, inMin, inMax, outMin, outMax) {
        return ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;
      }
    </script>
  </body>
</html>
